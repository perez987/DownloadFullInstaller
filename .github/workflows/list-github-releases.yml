name: list-github-releases

on:
  workflow_dispatch:
  release:
    types: [published]

jobs:
  list-releases:
    runs-on: ubuntu-latest
    permissions:
      contents: read
    steps:
      - name: List releases sorted by version (newest first)
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: |
          gh api repos/perez987/DownloadFullInstaller/releases --paginate \
            | jq -r '
                sort_by([.tag_name | split("-")[0] | split(".") | map(tonumber? // 0)])
                | reverse
                | .[]
                | "[\(.tag_name)] \(.name)\n  Published : \(.published_at)\n  URL       : \(.html_url)\n"
              '
